result: 100

მობილური ოპერატორის მონაცემთა ბაზა

მოცემულია მობილური ოპერატორი, რომელსაც მუშაობის გასაუმჯობესებლად ესაჭიროება მონაცემთა ბაზა. მობილური ოპერატორი ყიდის მობილური ტელეფონის ნომრებს ფიზიკურ პირებზე, აღრიცხავს მათ მიერ განხორციელებულ გამავალ და შემომავალ ზარებს და აღრიცხავს მობილური ტელეფონის ნომრის ბალანსს.

ბაზის შექმნისას უნდა იხელმძღვანელოთ შემდეგი ინფორმაციით:

სისტემაში ვინახავთ ფიზიკური პირების ჩამონათვალს, რომლებიც არიან მობილური ოპერატორის კლიენტები. თითოეულ ფიზიკური პირის შესახებ ვინახავთ შემდეგ ინფორმაციას:
უნიკალური იდენტიფიკატორი
პირადი ნომერი
სახელი
გვარი
დაბადების თარიღი

სისტემაში აგრეთვე ვინახავთ ფიზიკური პირების მისამართების შესახებ შემდეგ ინფორმაციას:
უნიკალური იდენტიფიკატორი
დასახლებული პუნქტის ტიპი (დასაშვები მნიშვნელობებია: ქალაქი, სოფელი)
დასახლებული პუნქტის სახელი
მისამართი
პიროვნების იდენტიფიკატორი, ვისაც ეს მისამართი ეკუთვნის

სისტემაში ვინახავთ მობილურის ტელეფონების ნომრების ჩამონათვალს, რომლებიც გაყიდულია მობილური ოპერატორის მიერ. თითოეული ნომრის შესახებ ვინახავთ შემდეგ ინფორმაციას:
უნიკალური იდენტიფიკატორი
ნომრის ინდექსი (დასაშვები მნიშვნელობებია: 522, 533, 544)
ნომერი
აქტიურია თუ არა (დასაშვები მნიშვნელობებია: true, false)
პიროვნების იდენტიფიკატორი, ვისაც ეს ნომერი ეკუთვნის

სისტემაში ვინახავთ მობილური ტელეფონების ნომრების ბალანსის ჩამონათვალს. თითოეული ბალანსის შესახებ ვინახავთ შემდეგ ინფორმაციას:
უნიკალური იდენტიფიკატორი
ბალანსი (თეთრების სიზუსტით)
ბალანსის რა ნაწილი არის დახარჯული (თეთრების სიზუსტით)
ბალანსის შევსების თარიღი
ნომრის იდენტიფიკატორი, რომელსაც ეს ბალანსი ეკუთვნის

სისტემაში ვინახავთ თითოეული გაყიდული ნომრის მიმართ განხორციელებული გამავალი და შემომავალი ზარების შესახებ შემდეგ ინფორმაციას:
უნიკალური იდენტიფიკატორი
ზარის ტიპი (დასაშვები მნიშვნელობებია: IN, OUT)
ჩვენს მიერ გაყიდული ნომრის იდენტიფიკატორი, რომელიც მონაწილეობდა განხორციელებულ ზარში
ამ ზარში მონაწილე მეორე ტელეფონის ნომერი(შეიძლება არ იყოს ჩვენს მიერ გაყიდული და იყოს უცხო ნომერი)
თარიღი როდესაც მოცემული ზარი განხორციელდა
მოცემული ზარის ხანგრძლივობა (წუთების სიზუსტით)
მოცემული ზარის ღირებულება (თეთრების სიზუსტით)

თქვენი ამოცანაა:

1. თქვენ მოგეწოდებათ hw2-dml.sql ფაილი, რომლშიც წერია ზემოდ აღწერილი ბაზის შესავსები dml ბრძანებები. თქვენ უნდა გამოიკვლიოთ ეს ფაილი და დაწეროთ ბაზის შესაქმენილი ddl ბრძანებები. აუცილებელია რომ თქვენს მიერ შექმნილი ბაზა ივსებოდეს მოწოდებული hw2-dml.sql ფაილით და არ უნდა ფიქსირდებოდეს შეცდომა. (10 ქულა)

2. დაწერეთ select-ი რომელიც დააბრუნებს იმ კლიენტების შესახებ ინფორმაციას, რომლებსაც 1-ზე მეტი ტელეფონის ნომერი აქვთ შეძენილი. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: სახელი, გვარი, პირადი ნომერი, შეძენილი ნომრების რაოდენობა. (10 ქულა)

3. დაწერეთ select-ი რომელიც დააბრუნებს მობილური ოპერატორის ყველაზე აქტიურ (მინიმუმ) 5 კლიენტს. აქტიურ კლიენტში იგულისხმება კლიენტი, რომლის მიერ ნაყიდი ნომრის მიმართ არის განხორციელებული ჯამურად ყველაზე მეტი შემომავალი და გამავალი ზარი. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: სახელი, გვარი, პირადი ნომერი, ტელეფონის ნომრის ინდექსი, ტელეფონის ნომერი, ჯამურად განხორციელებული ზარების რაოდენობა. (10 ქულა)

4. დაწერეთ select-ი რომელიც დააბრუნებს მობილური ოპერატორის ყველაზე აქტიურ კლიენტ(ებ)ს. აქტიურ კლიენტში იგულისხმება კლიენტი, რომლის მიერ ნაყიდი ნომრის მიმართ არის განხორციელებული ჯამურად ყველაზე მეტი შემომავალი და გამავალი ზარი. ეს select-ი უნდა დაწეროთ limit-ის გამოყენების გარეშე. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: სახელი, გვარი, პირადი ნომერი, ტელეფონის ნომრის ინდექსი, ტელეფონის ნომერი, ჯამურად განხორციელებული ზარების რაოდენობა. (10 ქულა)

5. დაწერეთ select-ი რომელიც დააბრუნებს სტატისტიკურ ინფორმაციას, თუ რამდენი ტელეფონის ნომერი აქვს გაყიდული მობილურ ოპერატორს დასახლებული პუნქტების მიხედვით. თქვენმა select-მა უნდა დააბრუნოს შემდეგი ინფორმაცია: დასახლებული პუქნტის ტიპი, დასახლებული პუნქტის სახელი, გაყიდული ნომრების რაოდენობა (თუ დასახლებულ პუნქტში არცერთი არაა გაყიდული მიეწეროს 0). (10 ქულა)

6. დაწერეთ select-ი რომელიც დააბრუნებს მობილური ტელეფონის ნომრის მიმართ განხორციელებულ შემომავალი ზარების ჯამურ ხანგრძლივობას და გამავალი ზარების ჯამურ ხანგრძლვივობას. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: ნომრის მფლობელის სახელი, გვარი, პირადი ნომერი, ტელეფონის ნომრის ინდექსი, ტელეფონის ნომერი, გამავალი ზარების ჯამური ხანგრძლივობა, შემომავალი ზარების ჯამური ხანგრძლივობა. (10 ქულა) (თუ არა აქვს არცერთი გამავალი და არც შემავალი ზარი, ეგეთი მფლობელები არ გამოიტანოთ)

7. დაწერეთ select-ი რომელიც დააბრუნებს მობილური ოპერატორის იმ კლიენტების შესახებ ინფორმაციას, რომლებიც ცხოვრობენ ქუთაისში, რომელთა სახელი იწყება ასობგერა 'ნ'-ზე და რომელთა შემომავალი ზარების ჯამური ხანგრძლვივობა ნაკლებია 90 წუთზე და მეტია 1 წუთზე. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: სახელი, გვარი, პირადი ნომერი, ტელეფონის ნომრის ინდექსი, ტელეფონის ნომერი, შემომავალი ზარების ჯამური ხანგრძლივობა. (10 ქულა)

8. დაწერეთ select-ი რომელიც დააბრუნებს თქვენს სისტემაში არსებულ ყველაზე პუპულარ ტელეფონის ნომრის ინდექსს. ყველაზე პოპულარული ტელეფონის ინდექსი განისაზღვრება იმით თუ რამდენი ტელეფონის ნომერია ამ ინდექსით გაყიდული. თქვენმა select-მა უნდა დააბრუნოს შემდეგი სვეტები: პოპულარული ინდექსი, ტელეფონის ნომრების რაოდენობა, რომლებიც გაიყიდა ამ ინდექსით. (10 ქულა)

9. ცხილს სადაც ვინახავთ ტელეფონის ნომრის მიმართ განხორციელებულ შემომავალ და გამავალ ზარების შესახებ ინფორმაციას დაადევით ტრიგერი, რომელიც ამ ცხრილში ინფორმაციის ჩაწერისას ავტომატურად განაახლებს შესაბამისი ტელეფონის ნომრის ბალანსს (სატელეფონო ზარის ტარიფი არის ერთი წუთი ერთი თეთრი). (10 ქულა)

10. დაწერეთ ფუნქცია სახელად has_balance, რომელსაც გადაეცემა ტელეფონის ნომრის იდენტიფიკატორი და დააბრუნებს მნიშვნელობას true ან false იმის მიხედვით არის ამ ტელეფონზე ხელმისაწვდომი ბალანსი თუ არა. (10 ქულა)
